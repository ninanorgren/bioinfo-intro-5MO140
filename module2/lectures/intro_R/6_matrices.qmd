---
title: "Complex data structures: Matrices"
subtitle: "<br>*Introduction to Bioinformatics - Module 2*"
author: "Nina Norgren"
format: 
    revealjs:
        theme: [serif, ../../../custom.scss]
        css: ../../module2.css
embed-resources: true
---

## Complex data structures

dim | Homogenous | Heterogenous
----|------------|-----------------
1d  | vectors    | list
2d  | matrices   | data frame
nd  | arrays     | n/a  

## Matrices

A **matrix** is a 2-dimensional data structure. Like vector, it consists of elements of the same type. A matrix has *rows* and *columns*.  

$$\mathbf{X} = \left[\begin{array}
{rrr}
1 & 2 & 3 \\
4 & 5 & 6 \\
7 & 8 & 9
\end{array}\right]$$

## Matrices

```{r, matrix, echo=T}
#| cache-vars: c(X)
X <- matrix(1:9, # numbers to fill
       nrow=3, # three rows (or ncol=3)
       byrow=T) # populate by row
```

<br>

:::{.fragment}
```{r, echo=T}
X
```
:::
 
## Matrices - indexing

Elements of a matrix are retrieved using the [].  
Two dimensions -- the row and the column:

```{r, echo=T}
X
```

<br>

```{r, echo=T}
X[1,2] # 1st row, 2nd column
```

## Matrices - indexing

Elements of a matrix are retrieved using the [].  
Two dimensions -- the row and the column:

```{r, echo=T}
X
```

<br>

```{r, echo=T}
X[3,] # The entire 3rd row
```

## Matrices - indexing

Elements of a matrix are retrieved using the [].  
Two dimensions -- the row and the column:

```{r, echo=T}
X
```

<br>

```{r, echo=T}
X[,2] # The 2nd column
```

## Matrices - dimensions

To check the dimensions of a matrix, use dim()

```{r, echo=T}
X
```

<br>

```{r, echo=T}
dim(X) # 3 rows and 3 columns
```

## Matrices - transposition

To **transpose** a matrix use t():

```{r, echo=T}
X
```

<br>

```{r echo=T}
t(X)
```

## Matrices - arithmetics

Same as for vectors, you can do different arithmetics
```{r matrix.multi, echo=T}
A <- matrix(1:4, nrow = 2, byrow=T)
B <- matrix(5:8, nrow = 2, byrow=T)
A
B 
```

## Matrices - addition

You can add 2 matrices together:
```{r, echo=T}
A + B # addition
```

## Matrices - multiplication

You can multiple 2 matrices:
```{r, echo=T}
A * B # product
```

## Matrices - apply

**apply()** applies a given *function* to either each value of the matrix or in a column/row-wise manner.  

<br>

Mean of values by column:

```{r matrix.apply, echo=T}
X
apply(X, MARGIN=2, mean) # 1 for rows
```

## Matrices - apply

Use **apply()** to add 1 to each value in the matrix:

```{r, echo=T}
X
```

## Matrices - apply

Use **apply()** to add 1 to each value in the matrix:
```{r, echo=T}
X
apply(X, MARGIN=c(1,2), 
     function(val) val + 1)
```

## Matrices - adding rows/columns

Add a row or a column to an already existing matrix, or make a matrix out of two or more vectors of equal length:

```{r, echo=T}
x <- c(1,1,1)
y <- c(2,2,2)
```

<br>

```{r, echo=T}
cbind(x,y)
```

## Matrices - adding rows/columns

Add a row or a column to an already existing matrix, or make a matrix out of two or more vectors of equal length:

```{r, echo=T}
x <- c(1,1,1)
y <- c(2,2,2)
```

<br>

```{r, echo=T}
rbind(x,y)
```

## Matrices - adding rows/columns

Add a row or a column to an already existing matrix, or make a matrix out of two or more vectors of equal length:

```{r, echo=T}
X
```

## Matrices - adding rows/columns

Add a row or a column to an already existing matrix, or make a matrix out of two or more vectors of equal length:

```{r, echo=T}
rbind(X, c(8,8,8))
```

## Matrices - adding rows/columns

Add a row or a column to an already existing matrix, or make a matrix out of two or more vectors of equal length:

```{r, echo=T}
cbind(X, c(8,8,8))
```